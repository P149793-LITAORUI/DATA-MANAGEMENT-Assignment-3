{"paragraphs":[{"text":"%sh\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.data -O /tmp/u.data\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.item -O /tmp/u.item\nwget http://media.sundog-soft.com/hadoop/ml-100k/u.user -O /tmp/u.user\n","user":"anonymous","dateUpdated":"2025-06-15T11:44:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2025-06-15 11:45:00--  http://media.sundog-soft.com/hadoop/ml-100k/u.data\nResolving media.sundog-soft.com (media.sundog-soft.com)... 52.217.132.137, 52.217.170.121, 3.5.27.223, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|52.217.132.137|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 2079229 (2.0M) [application/octet-stream]\nSaving to: ‘/tmp/u.data’\n\n     0K .......... .......... .......... .......... ..........  2% 99.8K 20s\n    50K .......... .......... .......... .......... ..........  4% 1.14M 10s\n   100K .......... .......... .......... .......... ..........  7%  241K 9s\n   150K .......... .......... .......... .......... ..........  9% 54.7M 7s\n   200K .......... .......... .......... .......... .......... 12%  202K 7s\n   250K .......... .......... .......... .......... .......... 14%  623K 6s\n   300K .......... .......... .......... .......... .......... 17%  297K 6s\n   350K .......... .......... .......... .......... .......... 19%  204K 6s\n   400K .......... .......... .......... .......... .......... 22% 18.3M 5s\n   450K .......... .......... .......... .......... .......... 24%  205K 5s\n   500K .......... .......... .......... .......... .......... 27% 13.2M 5s\n   550K .......... .......... .......... .......... .......... 29%  205K 5s\n   600K .......... .......... .......... .......... .......... 32% 16.6M 4s\n   650K .......... .......... .......... .......... .......... 34%  205K 4s\n   700K .......... .......... .......... .......... .......... 36% 21.6M 4s\n   750K .......... .......... .......... .......... .......... 39%  205K 4s\n   800K .......... .......... .......... .......... .......... 41% 29.7M 3s\n   850K .......... .......... .......... .......... .......... 44%  604K 3s\n   900K .......... .......... .......... .......... .......... 46%  304K 3s\n   950K .......... .......... .......... .......... .......... 49% 1.20M 3s\n  1000K .......... .......... .......... .......... .......... 51%  243K 3s\n  1050K .......... .......... .......... .......... .......... 54% 74.3M 3s\n  1100K .......... .......... .......... .......... .......... 56%  206K 2s\n  1150K .......... .......... .......... .......... .......... 59% 11.5M 2s\n  1200K .......... .......... .......... .......... .......... 61%  207K 2s\n  1250K .......... .......... .......... .......... .......... 64% 7.31M 2s\n  1300K .......... .......... .......... .......... .......... 66% 1.25M 2s\n  1350K .......... .......... .......... .......... .......... 68%  244K 2s\n  1400K .......... .......... .......... .......... .......... 71% 39.8M 1s\n  1450K .......... .......... .......... .......... .......... 73%  206K 1s\n  1500K .......... .......... .......... .......... .......... 76% 7.41M 1s\n  1550K .......... .......... .......... .......... .......... 78%  211K 1s\n  1600K .......... .......... .......... .......... .......... 81% 4.49M 1s\n  1650K .......... .......... .......... .......... .......... 83% 1.27M 1s\n  1700K .......... .......... .......... .......... .......... 86%  248K 1s\n  1750K .......... .......... .......... .......... .......... 88% 7.55M 1s\n  1800K .......... .......... .......... .......... .......... 91%  211K 0s\n  1850K .......... .......... .......... .......... .......... 93% 5.14M 0s\n  1900K .......... .......... .......... .......... .......... 96%  212K 0s\n  1950K .......... .......... .......... .......... .......... 98% 4.53M 0s\n  2000K .......... .......... ..........                      100%  119M=5.0s\n\n2025-06-15 11:45:06 (410 KB/s) - ‘/tmp/u.data’ saved [2079229/2079229]\n\n--2025-06-15 11:45:06--  http://media.sundog-soft.com/hadoop/ml-100k/u.item\nResolving media.sundog-soft.com (media.sundog-soft.com)... 3.5.25.135, 52.217.92.132, 16.15.177.34, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|3.5.25.135|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 236344 (231K) [application/octet-stream]\nSaving to: ‘/tmp/u.item’\n\n     0K .......... .......... .......... .......... .......... 21%  101K 2s\n    50K .......... .......... .......... .......... .......... 43%  207K 1s\n   100K .......... .......... .......... .......... .......... 64% 36.0M 0s\n   150K .......... .......... .......... .......... .......... 86% 1.06M 0s\n   200K .......... .......... ..........                      100%  157K=1.0s\n\n2025-06-15 11:45:07 (236 KB/s) - ‘/tmp/u.item’ saved [236344/236344]\n\n--2025-06-15 11:45:07--  http://media.sundog-soft.com/hadoop/ml-100k/u.user\nResolving media.sundog-soft.com (media.sundog-soft.com)... 3.5.8.156, 52.217.227.1, 52.217.169.97, ...\nConnecting to media.sundog-soft.com (media.sundog-soft.com)|3.5.8.156|:80... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 22628 (22K) [text/plain]\nSaving to: ‘/tmp/u.user’\n\n     0K .......... .......... ..                              100% 89.5K=0.2s\n\n2025-06-15 11:45:08 (89.5 KB/s) - ‘/tmp/u.user’ saved [22628/22628]\n\n"}]},"apps":[],"jobName":"paragraph_1749987679869_-1512188898","id":"20250615-114119_505541354","dateCreated":"2025-06-15T11:41:19+0000","dateStarted":"2025-06-15T11:44:59+0000","dateFinished":"2025-06-15T11:45:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:293"},{"text":"%sh\nhadoop fs -rm -r -f /tmp/ml-100k\nhadoop fs -mkdir /tmp/ml-100k\nhadoop fs -put /tmp/u.data /tmp/ml-100k/\nhadoop fs -put /tmp/u.item /tmp/ml-100k/\nhadoop fs -put /tmp/u.user /tmp/ml-100k/","user":"anonymous","dateUpdated":"2025-06-15T11:46:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1749987899389_-1353365868","id":"20250615-114459_322210463","dateCreated":"2025-06-15T11:44:59+0000","dateStarted":"2025-06-15T11:46:44+0000","dateFinished":"2025-06-15T11:47:00+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:294"},{"text":"val HDFS_PATH = \"hdfs:///tmp/ml-100k\"","user":"anonymous","dateUpdated":"2025-06-15T13:46:04+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"HDFS_PATH: String = hdfs:///tmp/ml-100k\n"}]},"apps":[],"jobName":"paragraph_1749988594951_-1292935099","id":"20250615-115634_1373761194","dateCreated":"2025-06-15T11:56:34+0000","dateStarted":"2025-06-15T13:46:04+0000","dateFinished":"2025-06-15T13:46:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:295"},{"text":"import spark.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._","user":"anonymous","dateUpdated":"2025-06-15T13:46:06+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import spark.implicits._\nimport org.apache.spark.sql._\nimport org.apache.spark.sql.functions._\nimport org.apache.spark.sql.types._\n"}]},"apps":[],"jobName":"paragraph_1749988768048_-770801838","id":"20250615-115928_47776498","dateCreated":"2025-06-15T11:59:28+0000","dateStarted":"2025-06-15T13:46:06+0000","dateFinished":"2025-06-15T13:46:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:296"},{"text":"final case class User(userID: Int, age: Int, gender: String, occupation: String, zipCode: String)\r\nfinal case class Movie(movieID: Int, title: String)\r\nfinal case class Rating(movieID: Int, rating: Int)\r\nfinal case class FullRating(userID: Int, movieID: Int, rating: Int) ","user":"anonymous","dateUpdated":"2025-06-15T13:46:10+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"warning: there was one unchecked warning; re-run with -unchecked for details\ndefined class User\nwarning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Movie\nwarning: there was one unchecked warning; re-run with -unchecked for details\ndefined class Rating\nwarning: there was one unchecked warning; re-run with -unchecked for details\ndefined class FullRating\n"}]},"apps":[],"jobName":"paragraph_1749991006961_-1652611856","id":"20250615-123646_1886692592","dateCreated":"2025-06-15T12:36:46+0000","dateStarted":"2025-06-15T13:46:10+0000","dateFinished":"2025-06-15T13:46:12+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:297"},{"text":"val fullRatingLines = sc.textFile(s\"$HDFS_PATH/u.data\")\r\n  .map(x => {\r\n    val fields = x.split(\"\\t\")\r\n    FullRating(fields(0).toInt, fields(1).toInt, fields(2).toInt)\r\n  })\r\nval fullRatingsDF = fullRatingLines.toDF()","user":"anonymous","dateUpdated":"2025-06-15T13:46:16+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"fullRatingLines: org.apache.spark.rdd.RDD[FullRating] = MapPartitionsRDD[2] at map at <console>:42\nfullRatingsDF: org.apache.spark.sql.DataFrame = [userID: int, movieID: int ... 1 more field]\n"}]},"apps":[],"jobName":"paragraph_1749991864936_-1111689961","id":"20250615-125104_1953813518","dateCreated":"2025-06-15T12:51:04+0000","dateStarted":"2025-06-15T13:46:16+0000","dateFinished":"2025-06-15T13:46:22+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:298"},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749992086736_-438842400","id":"20250615-125446_682269918","dateCreated":"2025-06-15T12:54:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:299","text":"val userLines = sc.textFile(s\"$HDFS_PATH/u.user\")\r\n  .map(x => {\r\n    val fields = x.split(\"\\\\|\")\r\n    User(fields(0).toInt, fields(1).toInt, fields(2), fields(3), fields(4))\r\n  })\r\nval usersDF = userLines.toDF()\r\n","dateUpdated":"2025-06-15T13:46:33+0000","dateFinished":"2025-06-15T13:46:35+0000","dateStarted":"2025-06-15T13:46:33+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"userLines: org.apache.spark.rdd.RDD[User] = MapPartitionsRDD[5] at map at <console>:42\nusersDF: org.apache.spark.sql.DataFrame = [userID: int, age: int ... 3 more fields]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995193722_-1791530877","id":"20250615-134633_2083524801","dateCreated":"2025-06-15T13:46:33+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:973","text":"val movieLines = sc.textFile(s\"$HDFS_PATH/u.item\")\r\n  .map(x => {\r\n    val fields = x.split(\"\\\\|\")\r\n    Movie(fields(0).toInt, fields(1))\r\n  })\r\nval moviesDF = movieLines.toDF()","dateUpdated":"2025-06-15T13:46:44+0000","dateFinished":"2025-06-15T13:46:45+0000","dateStarted":"2025-06-15T13:46:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"movieLines: org.apache.spark.rdd.RDD[Movie] = MapPartitionsRDD[8] at map at <console>:42\nmoviesDF: org.apache.spark.sql.DataFrame = [movieID: int, title: string]\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995204666_1247616009","id":"20250615-134644_1531826448","dateCreated":"2025-06-15T13:46:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1057","text":"\r\nusersDF.printSchema()\r\nmoviesDF.printSchema()\r\nfullRatingsDF.printSchema()","dateUpdated":"2025-06-15T13:47:07+0000","dateFinished":"2025-06-15T13:47:08+0000","dateStarted":"2025-06-15T13:47:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- userID: integer (nullable = false)\n |-- age: integer (nullable = false)\n |-- gender: string (nullable = true)\n |-- occupation: string (nullable = true)\n |-- zipCode: string (nullable = true)\n\nroot\n |-- movieID: integer (nullable = false)\n |-- title: string (nullable = true)\n\nroot\n |-- userID: integer (nullable = false)\n |-- movieID: integer (nullable = false)\n |-- rating: integer (nullable = false)\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995227627_-1254993340","id":"20250615-134707_2093491725","dateCreated":"2025-06-15T13:47:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1150","text":"usersDF.createOrReplaceTempView(\"ml_users\")\r\nmoviesDF.createOrReplaceTempView(\"ml_movies\")\r\nfullRatingsDF.createOrReplaceTempView(\"ml_full_ratings\")","dateUpdated":"2025-06-15T13:48:52+0000","dateFinished":"2025-06-15T13:48:54+0000","dateStarted":"2025-06-15T13:48:53+0000","results":{"code":"SUCCESS","msg":[]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995332622_-1683249514","id":"20250615-134852_1671325779","dateCreated":"2025-06-15T13:48:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1237","text":"println(\"\\nQ1:\")\r\nval q1 = fullRatingsDF\r\n  .join(moviesDF, \"movieID\")\r\n  .groupBy(\"title\")\r\n  .agg(round(avg(\"rating\"), 2).as(\"avg_rating\"))\r\n  .orderBy(desc(\"avg_rating\"))\r\n  .limit(10)\r\nq1.show(truncate = false)","dateUpdated":"2025-06-15T13:50:35+0000","dateFinished":"2025-06-15T13:50:54+0000","dateStarted":"2025-06-15T13:50:35+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nQ1:\nq1: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [title: string, avg_rating: double]\n+-------------------------------------------------+----------+\n|title                                            |avg_rating|\n+-------------------------------------------------+----------+\n|Someone Else's America (1995)                    |5.0       |\n|Saint of Fort Washington, The (1993)             |5.0       |\n|Marlene Dietrich: Shadow and Light (1996)        |5.0       |\n|Aiqing wansui (1994)                             |5.0       |\n|Star Kid (1997)                                  |5.0       |\n|Great Day in Harlem, A (1994)                    |5.0       |\n|Entertaining Angels: The Dorothy Day Story (1996)|5.0       |\n|They Made Me a Criminal (1939)                   |5.0       |\n|Santa with Muscles (1996)                        |5.0       |\n|Prefontaine (1997)                               |5.0       |\n+-------------------------------------------------+----------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995392615_1470445275","id":"20250615-134952_540762728","dateCreated":"2025-06-15T13:49:52+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1305","text":"println(\"\\nQ2:\")\r\nval q2 = spark.sql(\"\"\"\r\nSELECT \r\n  m.title, \r\n  ROUND(AVG(r.rating), 2) AS avg_rating,\r\n  COUNT(*) AS reviews\r\nFROM ml_full_ratings r \r\nJOIN ml_movies m ON r.movieID = m.movieID\r\nGROUP BY m.title\r\nHAVING COUNT(*) >= 50\r\nORDER BY avg_rating DESC\r\nLIMIT 10\r\n\"\"\")\r\nq2.show(truncate = false)","dateUpdated":"2025-06-15T13:51:16+0000","dateFinished":"2025-06-15T13:51:28+0000","dateStarted":"2025-06-15T13:51:16+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nQ2:\nq2: org.apache.spark.sql.DataFrame = [title: string, avg_rating: double ... 1 more field]\n+------------------------------------------------------+----------+-------+\n|title                                                 |avg_rating|reviews|\n+------------------------------------------------------+----------+-------+\n|Close Shave, A (1995)                                 |4.49      |112    |\n|Schindler's List (1993)                               |4.47      |298    |\n|Wrong Trousers, The (1993)                            |4.47      |118    |\n|Casablanca (1942)                                     |4.46      |243    |\n|Wallace & Gromit: The Best of Aardman Animation (1996)|4.45      |67     |\n|Shawshank Redemption, The (1994)                      |4.45      |283    |\n|Rear Window (1954)                                    |4.39      |209    |\n|Usual Suspects, The (1995)                            |4.39      |267    |\n|Star Wars (1977)                                      |4.36      |584    |\n|12 Angry Men (1957)                                   |4.34      |125    |\n+------------------------------------------------------+----------+-------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995476007_-83632154","id":"20250615-135116_1476791654","dateCreated":"2025-06-15T13:51:16+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1432","text":"import org.apache.spark.sql.expressions.Window\r\nprintln(\"\\nQ3:\")\r\nval fullRatingLine = sc.textFile(s\"$HDFS_PATH/u.data\")\r\n  .map(x => {\r\n    val fields = x.split(\"\\t\")\r\n    (fields(0).toInt, fields(1).toInt, fields(2).toInt)\r\n  })\r\n  .toDF(\"userID\", \"movieID\", \"rating\")\r\nval windowSpec = Window\r\n  .partitionBy(\"userID\")\r\n  .orderBy(desc(\"rating\"))\r\n\r\nval userFavorites = fullRatingLine\r\n  .join(moviesDF, \"movieID\")\r\n  .withColumn(\"rank\", row_number().over(windowSpec))\r\n  .filter(col(\"rank\") === 1)\r\n  .select(col(\"userID\"), col(\"title\").as(\"favorite_movie\"))\r\n\r\nval activeUsers = fullRatingLine\r\n  .groupBy(\"userID\")\r\n  .agg(count(\"*\").as(\"ratings_count\"))\r\n  .filter(col(\"ratings_count\") >= 50)\r\n\r\nval q3 = activeUsers\r\n  .join(usersDF, \"userID\")\r\n  .join(userFavorites, \"userID\")\r\n  .select(\"userID\", \"age\", \"gender\", \"occupation\", \"favorite_movie\")\r\n  .orderBy(\"userID\")\r\n  .limit(10)\r\nq3.show(truncate = false)","dateUpdated":"2025-06-15T14:17:25+0000","dateFinished":"2025-06-15T14:17:44+0000","dateStarted":"2025-06-15T14:17:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"import org.apache.spark.sql.expressions.Window\n\nQ3:\nfullRatingLine: org.apache.spark.sql.DataFrame = [userID: int, movieID: int ... 1 more field]\nwindowSpec: org.apache.spark.sql.expressions.WindowSpec = org.apache.spark.sql.expressions.WindowSpec@3901c38c\nuserFavorites: org.apache.spark.sql.DataFrame = [userID: int, favorite_movie: string]\nactiveUsers: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, ratings_count: bigint]\nq3: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, age: int ... 3 more fields]\n+------+---+------+-------------+-------------------------------------------------------------------+\n|userID|age|gender|occupation   |favorite_movie                                                     |\n+------+---+------+-------------+-------------------------------------------------------------------+\n|1     |24 |M     |technician   |Big Night (1996)                                                   |\n|2     |53 |F     |other        |Shall We Dance? (1996)                                             |\n|3     |23 |M     |writer       |Mother (1996)                                                      |\n|5     |33 |F     |other        |Heavy Metal (1981)                                                 |\n|6     |42 |M     |executive    |Big Night (1996)                                                   |\n|7     |57 |M     |administrator|It's a Wonderful Life (1946)                                       |\n|8     |36 |M     |administrator|Alien (1979)                                                       |\n|10    |53 |M     |lawyer       |It's a Wonderful Life (1946)                                       |\n|11    |39 |F     |other        |Englishman Who Went Up a Hill, But Came Down a Mountain, The (1995)|\n|12    |28 |F     |other        |Courage Under Fire (1996)                                          |\n+------+---+------+-------------+-------------------------------------------------------------------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995525487_1585252044","id":"20250615-135205_1208917065","dateCreated":"2025-06-15T13:52:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1521","text":"println(\"\\nQ4:\")\r\nval q4 = usersDF\r\n  .filter(col(\"age\") < 20)\r\n  .select(\"userID\", \"age\", \"occupation\")\r\n  .orderBy(asc(\"age\"))\r\n  .limit(10)\r\nq4.show(truncate = false)","dateUpdated":"2025-06-15T13:54:34+0000","dateFinished":"2025-06-15T13:54:35+0000","dateStarted":"2025-06-15T13:54:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nQ4:\nq4: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, age: int ... 1 more field]\n+------+---+----------+\n|userID|age|occupation|\n+------+---+----------+\n|30    |7  |student   |\n|471   |10 |student   |\n|289   |11 |none      |\n|142   |13 |other     |\n|609   |13 |student   |\n|628   |13 |none      |\n|674   |13 |student   |\n|880   |13 |student   |\n|206   |14 |student   |\n|813   |14 |student   |\n+------+---+----------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995674198_-624914204","id":"20250615-135434_1490671250","dateCreated":"2025-06-15T13:54:34+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1610","text":"println(\"\\nQ5:\")\r\nval q5 = usersDF\r\n  .filter(col(\"occupation\") === \"scientist\")\r\n  .filter(col(\"age\").between(30, 40))\r\n  .select(\"userID\", \"age\", \"occupation\")\r\n  .orderBy(asc(\"age\"))\r\n  .limit(10)\r\nq5.show(truncate = false)","dateUpdated":"2025-06-15T13:54:52+0000","dateFinished":"2025-06-15T13:54:53+0000","dateStarted":"2025-06-15T13:54:52+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"\nQ5:\nq5: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [userID: int, age: int ... 1 more field]\n+------+---+----------+\n|userID|age|occupation|\n+------+---+----------+\n|538   |31 |scientist |\n|730   |31 |scientist |\n|554   |32 |scientist |\n|183   |33 |scientist |\n|272   |33 |scientist |\n|543   |33 |scientist |\n|874   |36 |scientist |\n|337   |37 |scientist |\n|40    |38 |scientist |\n|430   |38 |scientist |\n+------+---+----------+\n\n"}]}},{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1749995692461_-322639486","id":"20250615-135452_746255266","dateCreated":"2025-06-15T13:54:52+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1694"}],"name":"Assignment_3","id":"2KYR5A76U","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}